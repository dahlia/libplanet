<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Contributor guide | Libplanet </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Contributor guide | Libplanet ">
    <meta name="generator" content="docfx 2.48.1.0">
    
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="stylesheet" href="styles/docfx.vendor.css">
    <link rel="stylesheet" href="styles/docfx.css">
    <link rel="stylesheet" href="styles/main.css">
    <meta property="docfx:navrel" content="toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="index.html">
                <img id="logo" class="svg" src="images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        <div class="article row grid">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="contributor-guide">Contributor guide</h1>

<p>Note: This document at present is for only code contributors.
We should expand it so that it covers reporting bugs, filing issues,
and writing docs.</p>
<h2 id="questions--online-chat--discord">Questions &amp; online chat  <a href="https://discord.gg/planetarium"><img src="https://img.shields.io/discord/539405872346955788.svg?color=7289da&amp;logo=discord&amp;logoColor=white" alt="Discord"></a></h2>
<p>We have a <a href="https://discord.gg/planetarium">Discord server</a> to discuss Libplanet.  There are some channels
for purposes in the <em>Libplanet</em> category:</p>
<ul>
<li><em>#announcement</em>: Maintainers announce events like our roadmap or local
events.</li>
<li><em>#users</em>: Chat with game programmers who use Libplanet.
Ask questions to <em>use</em> Libplanet for your games.</li>
<li><em>#development</em>: Chat with maintainers and contributors of Libplanet.
Ask questions to <em>hack</em> Libplanet and to make a patch for it.</li>
<li><em>#users-ko</em>: The same purpose to <em>#users</em>,
except you can speak Korean instead English here.</li>
<li><em>#development-ko</em>: The same purpose to <em>#development</em>,
except you can speak Korean instead English here.</li>
</ul>
<h2 id="prerequisites">Prerequisites</h2>
<p>You need <a href="https://dot.net/">.NET Core</a> SDK 3.1+ which provides the latest C# compiler and .NET VM.
Read and follow the instruction to install .NET Core SDK on
the <a href="https://dotnet.microsoft.com/download">.NET Core downloads page</a>.
FYI if you use macOS and <a href="https://brew.sh/">Homebrew</a> you can install it by
<code>brew cask install dotnet-sdk</code> command.</p>
<p>Make sure that your .NET Core SDK is 3.1 or higher.  You could show
the version you are using by <code>dotnet --info</code> command.</p>
<p>Although it is not necessary, you should install a proper IDE for .NET
(or an <a href="http://www.omnisharp.net/">OmniSharp</a> extension for your favorite editor — except it takes
hours to properly configure and integrate with your editor).
C# is not like JavaScript or Python; it is painful to code in C# without IDE.</p>
<p>Unless you already have your favorite setup, we recommend you to use
<a href="https://code.visualstudio.com/">Visual Studio Code</a>.  It is free, open source, and made by Microsoft, which
made .NET as well.  So Visual Studio Code has a <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.csharp">first-party C# extension</a>
which works well together.</p>
<h2 id="build">Build</h2>
<p>The following command installs dependencies (required library packages) and
builds the entire <em>Libplanet</em> solution:</p>
<pre><code>dotnet build
</code></pre>
<h2 id="projects">Projects</h2>
<p>The <a href="https://github.com/planetarium/libplanet">planetarium/libplanet</a> repository
on GitHub consists of several projects:</p>
<ul>
<li><p><em>Libplanet</em>: The main project, which contains the most of implementation
code.  When this is  built into a <a href="https://www.nuget.org/packages/Libplanet/">NuGet package</a>, it consists of two
assemblies: <em>Libplanet</em>, and <em>Libplanet.Stun</em>, explained below.</p>
</li>
<li><p><em>Libplanet.Stun</em>: The project dedicated to implement <a href="https://snack.planetarium.dev/eng/2019/06/nat_traversal_2/">TURN &amp; STUN</a>.
Note that the assembly built from this project is included by
<em><a href="https://www.nuget.org/packages/Libplanet/">Libplanet</a></em> package on NuGet.</p>
</li>
<li><p><em>Libplanet.RocksDBStore</em>: The <code>IStore</code> implementation built on <a href="https://rocksdb.org/">RocksDB</a>.
As this depends on platform-dependent libraries (which is written in C/C++),
this is distributed as a distinct NuGet package: <em><a href="https://www.nuget.org/packages/Libplanet.RocksDBStore/">Libplanet.RocksDBStore</a></em>.</p>
</li>
<li><p><em>Libplanet.Tools</em>: The CLI tools for Libplanet.  See its own
<a href="cli/README.html">README.md</a>.</p>
</li>
<li><p><em>Libplanet.Benchmarks</em>: Performance benchmarks.
See the <a href="#benchmarks"><em>Benchmarks</em></a> section below.</p>
</li>
<li><p><em>Libplanet.Tests</em>: Unit tests of the <em>Libplanet</em> project.  See the <em>Tests</em>
section below.</p>
</li>
<li><p><em>Libplanet.Stun.Tests</em>: Unit tests of the <em>Libplanet.Stun</em> project.</p>
</li>
<li><p><em>Libplanet.RocksDBStore.Tests</em>: Unit tests of the <em>Libplanet.RocksDBStore</em>
project.</p>
</li>
</ul>
<h2 id="tests-build-status-codecov">Tests <a href="https://dev.azure.com/planetarium/libplanet/_build/latest?definitionId=1&amp;branchName=master"><img src="https://dev.azure.com/planetarium/libplanet/_apis/build/status/planetarium.libplanet?branchName=master" alt="Build Status"></a> <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode.csharp"><img src="https://codecov.io/gh/planetarium/libplanet/branch/master/graph/badge.svg" alt="Codecov"></a></h2>
<p>We write as complete tests as possible to the corresponding implementation code.
Going near to the <a href="https://codecov.io/gh/planetarium/libplanet">code coverage</a> 100% is one of our goals.</p>
<p>The <em>Libplanet</em> solution consists of several projects.
Every project without <em>.Tests</em> suffix is an actual implementation.
These are built to <em>Libplanet*.dll</em> assemblies and packed into one NuGet
package.</p>
<p><em>Libplanet*.Tests</em> is a test suite for the <em>Libplanet*.dll</em> assembly.
All of them depend on <a href="https://xunit.github.io/">Xunit</a>, and every namespace and class in these
corresponds to one in <em>Libplanet*</em> projects.
If there's <em>Libplanet.Foo.Bar</em> class there also should be
<em>Libplanet.Foo.Bar.Tests</em> to test it.</p>
<p>To build and run unit tests at a time execute the below command:</p>
<pre><code>dotnet test
</code></pre>
<h3 id="turn_server_url"><code>TURN_SERVER_URL</code></h3>
<p>Some tests depend on a TURN server.  If <code>TURN_SERVER_URL</code> environment variable
is set (the value looks like <code>turn://user:password@host:3478/</code>)
these tests also run.  Otherwise, these tests are skipped.</p>
<p>FYI there are several TURN implementations like <a href="https://github.com/coturn/coturn">Coturn</a> and <a href="https://github.com/gortc/turn">gortc/turn</a>,
or cloud offers like <a href="https://xirsys.com/">Xirsys</a>.</p>
<h3 id="xunit-unity-runner"><a href="https://github.com/planetarium/xunit-unity-runner">xunit-unity-runner</a></h3>
<p>Unity is one of our platforms we primarily target to support, so we've been
testing Libplanet on the actual Unity runtime, and you could see whether it's
passed on <a href="https://dev.azure.com/planetarium/libplanet/_build/latest?definitionId=1&amp;branchName=master">Azure Pipelines</a>.</p>
<p>However, if it fails and it does not fail on other platforms but only Unity,
you need to run Unity tests on your own machine so that you rapidily and
repeatedly tinker things, make a try, and immediately get feedback from them.</p>
<p>Here's how to run Unity tests on your machine.  We've made and used
<a href="https://github.com/planetarium/xunit-unity-runner">xunit-unity-runner</a> to run <a href="https://xunit.github.io/">Xunit</a> tests on the actual Unity runtime,
and our build jobs on Azure Pipelines also use this.  This test runner
is actually a Unity app, though it's not a game app.  As of June 2019,
there are <a href="https://github.com/planetarium/xunit-unity-runner/releases/latest">executable binaries</a> for Linux, macOS, and Windows.
Its usage is simple.  It's a CLI app that takes <em>absolute</em> paths to
.NET assemblies (<em>.dll</em>) that consist of test classes (based on Xunit).</p>
<p>You can build these assemblies using <code>msbuild -r</code> Mono or .NET Framework
provide.
<em>You can't build them using <code>dotnet build</code> command or <code>dotnet msbuild</code>,</em>
because the Unity runtime is not based on .NET Core but Mono,
which is compatible with .NET Framework 4.6.
Please be sure that Mono's <em>bin</em> directory is prior to .NET Core's one
(or it's okay too if .NET Core is not installed at all).  Mono or .NET
Framework's <code>msbuild</code> could try to use .NET Core's version of several
utilities during build, and this could cause some errors.</p>
<p>The way to execute the runner binary depend on the platform.  For details,
please read <a href="https://github.com/planetarium/xunit-unity-runner">xunit-unity-runner</a>'s README.  FYI you can use <code>-h</code>/<code>--help</code>
option as well.</p>
<p>To sum up, the instruction is like below (the example is assuming Linux):</p>
<pre><code>msbuild -r
xunit-unity-runner/StandaloneLinux64 \
  &quot;`pwd`&quot;/*.Tests/bin/Debug/net47/*.Tests.dll
</code></pre>
<h2 id="style-convention">Style convention</h2>
<p>Please follow the existing coding convention.  We are already using several
static analyzers.  They are automatically executed together with <code>msbuild</code>,
and will warn you if there are any style errors.</p>
<p>You should also register Git hooks we commonly use:</p>
<pre><code>git config core.hooksPath hooks
</code></pre>
<p>We highly recommend you to install an extension for <a href="https://editorconfig.org/">EditorConfig</a> in your
favorite editor.  Some recent editors have built-in support for EditorConfig,
e.g., Rider (IntelliJ IDEA), Visual Studio.  Many editors have an extension to
support EditorConfig, e.g., <a href="https://atom.io/packages/editorconfig">Atom</a>, <a href="https://github.com/editorconfig/editorconfig-emacs">Emacs</a>, <a href="https://github.com/editorconfig/editorconfig-vim">Vim</a>, <a href="https://marketplace.visualstudio.com/items?itemName=EditorConfig.EditorConfig">VS Code</a>.</p>
<h2 id="benchmarks">Benchmarks</h2>
<p>In order to track performance improvements or regressions, we maintain a set of
benchmarks and continuously measure them in the CI.  You can run benchmarks
on your local environment too:</p>
<pre><code>dotnet run -p Libplanet.Benchmarks -c Release -- -j short -f &quot;*&quot;
</code></pre>
<p>Note that there is <code>-j short</code>; without this a whole set of benchmarks takes
quite a long time.  This will print like below:</p>
<pre><code>|               Method | UnrollFactor |      Mean |      Error |    StdDev |
|--------------------- |------------- |----------:|-----------:|----------:|
|       MineBlockEmpty |           16 |  12.20 ms |  11.649 ms | 0.6385 ms |
|  MineBlockOneTran... |            1 |  14.54 ms |   3.602 ms | 0.1974 ms |
|                  ... |          ... |       ... |        ... |       ... |
</code></pre>
<p>You can measure only part of benchmarks by <code>-f</code>/<code>--filter</code>ing them:</p>
<pre><code>dotnet run -p Libplanet.Benchmarks -c Release -- -j short -f &quot;*MineBlock*&quot;
</code></pre>
<p>All benchmark code is placed under <em>Libplanet.Benchmarks</em> project.
As our benchmarks are based on <a href="https://benchmarkdotnet.org/">BenchmarkDotNet</a>, please read their official
docs for details.</p>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/dahlia/libplanet/blob/npm/CONTRIBUTING.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            Copyright © 2019–2020 <a href="https://planetariumhq.com/">Planetarium</a>
            
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="styles/docfx.js"></script>
    <script type="text/javascript" src="styles/main.js"></script>
  </body>
</html>
